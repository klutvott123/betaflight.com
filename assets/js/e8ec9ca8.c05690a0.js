"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3558],{3905:(t,l,e)=>{e.d(l,{Zo:()=>k,kt:()=>f});var n=e(67294);function u(t,l,e){return l in t?Object.defineProperty(t,l,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[l]=e,t}function r(t,l){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);l&&(n=n.filter((function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),e.push.apply(e,n)}return e}function i(t){for(var l=1;l<arguments.length;l++){var e=null!=arguments[l]?arguments[l]:{};l%2?r(Object(e),!0).forEach((function(l){u(t,l,e[l])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(e,l))}))}return t}function a(t,l){if(null==t)return{};var e,n,u=function(t,l){if(null==t)return{};var e,n,u={},r=Object.keys(t);for(n=0;n<r.length;n++)e=r[n],l.indexOf(e)>=0||(u[e]=t[e]);return u}(t,l);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)e=r[n],l.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(u[e]=t[e])}return u}var o=n.createContext({}),d=function(t){var l=n.useContext(o),e=l;return t&&(e="function"==typeof t?t(l):i(i({},l),t)),e},k=function(t){var l=d(t.components);return n.createElement(o.Provider,{value:l},t.children)},s="mdxType",c={inlineCode:"code",wrapper:function(t){var l=t.children;return n.createElement(n.Fragment,{},l)}},h=n.forwardRef((function(t,l){var e=t.components,u=t.mdxType,r=t.originalType,o=t.parentName,k=a(t,["components","mdxType","originalType","parentName"]),s=d(e),h=u,f=s["".concat(o,".").concat(h)]||s[h]||c[h]||r;return e?n.createElement(f,i(i({ref:l},k),{},{components:e})):n.createElement(f,i({ref:l},k))}));function f(t,l){var e=arguments,u=l&&l.mdxType;if("string"==typeof t||u){var r=e.length,i=new Array(r);i[0]=h;var a={};for(var o in l)hasOwnProperty.call(l,o)&&(a[o]=l[o]);a.originalType=t,a[s]="string"==typeof t?t:u,i[1]=a;for(var d=2;d<r;d++)i[d]=e[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,e)}h.displayName="MDXCreateElement"},39398:(t,l,e)=>{e.r(l),e.d(l,{assets:()=>o,contentTitle:()=>i,default:()=>s,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var n=e(87462),u=(e(67294),e(3905));const r={},i="Arming Sequence & Safety",a={unversionedId:"wiki/archive/Arming-Sequence-And-Safety",id:"wiki/archive/Arming-Sequence-And-Safety",title:"Arming Sequence & Safety",description:"Switch arming",source:"@site/docs/wiki/archive/Arming-Sequence-And-Safety.md",sourceDirName:"wiki/archive",slug:"/wiki/archive/Arming-Sequence-And-Safety",permalink:"/betaflight.com/docs/wiki/archive/Arming-Sequence-And-Safety",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"wiki",previous:{title:"Acro Trainer",permalink:"/betaflight.com/docs/wiki/archive/Acro-Trainer"},next:{title:"Barometer Configuration",permalink:"/betaflight.com/docs/wiki/archive/Barometer-Configuration"}},o={},d=[{value:"Switch arming",id:"switch-arming",level:2},{value:"Arming Prevention",id:"arming-prevention",level:2},{value:"CLI",id:"cli",level:2},{value:"Beeper",id:"beeper",level:2},{value:"Description of arming prevention flags",id:"description-of-arming-prevention-flags",level:2}],k={toc:d};function s(t){let{components:l,...e}=t;return(0,u.kt)("wrapper",(0,n.Z)({},k,e,{components:l,mdxType:"MDXLayout"}),(0,u.kt)("h1",{id:"arming-sequence--safety"},"Arming Sequence & Safety"),(0,u.kt)("h2",{id:"switch-arming"},"Switch arming"),(0,u.kt)("p",null,'The AUX channel configured for arming will choose a default value that falls outside of the configured arm range (as configured in the "Modes" configurator tab), this value is either 1 "step" (25us) above or below the configured range. This is a safety feature to ensure the default value would not cause accidental arming.'),(0,u.kt)("p",null,"Note that this default value is overwritten by the first values data from the receiver, therefore bad RX initial states or failsafe settings can still cause issues."),(0,u.kt)("h2",{id:"arming-prevention"},"Arming Prevention"),(0,u.kt)("p",null,"Betaflight 3.2 (and above) includes more detailed troubleshooting information for the case when a craft will not arm."),(0,u.kt)("p",null,"This information is available via:"),(0,u.kt)("ul",null,(0,u.kt)("li",{parentName:"ul"},"the CLI"),(0,u.kt)("li",{parentName:"ul"},"Betaflight OSD"),(0,u.kt)("li",{parentName:"ul"},"beep patterns"),(0,u.kt)("li",{parentName:"ul"},"Betaflight Configurator")),(0,u.kt)("p",null,"Several of these conditions are to assist in preventing accidental arming via bad radio system configuration, unreliable/poor quality receivers and user mistakes."),(0,u.kt)("p",null,"These reasons for not arming are encoded as a set of flags (see ",(0,u.kt)("a",{parentName:"p",href:"https://github.com/betaflight/betaflight/blob/master/src/main/fc/runtime_config.h"},"runtime_config.h"),")."),(0,u.kt)("h2",{id:"cli"},"CLI"),(0,u.kt)("p",null,"Flags can be viewed via the ",(0,u.kt)("inlineCode",{parentName:"p"},"status")," command."),(0,u.kt)("p",null,"Some targets with limited flash space will only provide the hexadecimal representation of these flags, in which case the active flags must be derived from the ",(0,u.kt)("inlineCode",{parentName:"p"},"armingDisableFlags_e")," enum in ",(0,u.kt)("inlineCode",{parentName:"p"},"runtime_config.h")," (ensure the version of the file you are looking at matches that of your firmware)."),(0,u.kt)("h2",{id:"beeper"},"Beeper"),(0,u.kt)("p",null,"When arming is attempted and fails, if a beeper is connected to the flight controller it will emit a warning signal indicating the most important (lowest number) reason why disarming is disabled."),(0,u.kt)("p",null,"The signal is as follows:"),(0,u.kt)("ul",null,(0,u.kt)("li",{parentName:"ul"},"five short 'attention' beeps;"),(0,u.kt)("li",{parentName:"ul"},"a number of long beeps (may be 0);"),(0,u.kt)("li",{parentName:"ul"},"a number of short beeps with long intervals (may be 0).")),(0,u.kt)("p",null,"The arming prevention condition that is active can be calculated as ",(0,u.kt)("inlineCode",{parentName:"p"},"(5 * <number of long beeps>) + <number of short beeps>"),". For example:"),(0,u.kt)("ul",null,(0,u.kt)("li",{parentName:"ul"},"1 long and 2 short beeps = 7"),(0,u.kt)("li",{parentName:"ul"},"2 long beeps = 10")),(0,u.kt)("h2",{id:"description-of-arming-prevention-flags"},"Description of arming prevention flags"),(0,u.kt)("p",null,"What each flag means and what you should do to (probably) fix the issue."),(0,u.kt)("p",null,"This list ",(0,u.kt)("em",{parentName:"p"},"should")," be kept up to date with the code in ",(0,u.kt)("inlineCode",{parentName:"p"},"master")," (",(0,u.kt)("inlineCode",{parentName:"p"},"armingDisableFlags_e")," in ",(0,u.kt)("a",{parentName:"p",href:"https://github.com/betaflight/betaflight/blob/master/src/main/fc/runtime_config.h#L37-L60"},"src/main/fc/runtime_config.h"),") so can be used to find what flag corresponds to a certain index, however if you run an older version you'd have to check this manually as mentioned above."),(0,u.kt)("table",null,(0,u.kt)("tr",null,(0,u.kt)("th",{rowspan:"2"},"Name"),(0,u.kt)("th",{rowspan:"2"},"Description"),(0,u.kt)("th",{colspan:"6"},"Beep code"),(0,u.kt)("th",{rowspan:"2"},"Required Actions")),(0,u.kt)("tr",null,(0,u.kt)("th",null,"3.2"),(0,u.kt)("th",null,"3.3"),(0,u.kt)("th",null,"3.4/3.5"),(0,u.kt)("th",null,"4.0"),(0,u.kt)("th",null,"4.1"),(0,u.kt)("th",null,"4.2+")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"NOGYRO")),(0,u.kt)("td",null,"A gyro was not detected"),(0,u.kt)("td",null,"1"),(0,u.kt)("td",null,"1"),(0,u.kt)("td",null,"1"),(0,u.kt)("td",null,"1"),(0,u.kt)("td",null,"1"),(0,u.kt)("td",null,"1"),(0,u.kt)("td",null,"You may have a hardware failure, if a previous firmware version works then it may be a firmware issue. Or you might have flashed a wrong target.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"FAILSAFE")),(0,u.kt)("td",null,"Failsafe is active"),(0,u.kt)("td",null,"2"),(0,u.kt)("td",null,"2"),(0,u.kt)("td",null,"2"),(0,u.kt)("td",null,"2"),(0,u.kt)("td",null,"2"),(0,u.kt)("td",null,"2"),(0,u.kt)("td",null,"Rectify the failure condition and try again.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"RXLOSS"),(0,u.kt)("sup",null,"(1)")," or ",(0,u.kt)("code",null,"RX_FAILSAFE")),(0,u.kt)("td",null,"No valid receiver signal is detected"),(0,u.kt)("td",null,"3"),(0,u.kt)("td",null,"3"),(0,u.kt)("td",null,"3"),(0,u.kt)("td",null,"3"),(0,u.kt)("td",null,"3"),(0,u.kt)("td",null,"3"),(0,u.kt)("td",null,"Your receiver is either faulty or has no link to the transmitter.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"BADRX"),(0,u.kt)("sup",null,"(1)")),(0,u.kt)("td",null,"Your receiver has just recovered from receiver failsafe but the arm switch is on"),(0,u.kt)("td",null,"4"),(0,u.kt)("td",null,"4"),(0,u.kt)("td",null,"4"),(0,u.kt)("td",null,"4"),(0,u.kt)("td",null,"4"),(0,u.kt)("td",null,"4"),(0,u.kt)("td",null,"Switch the arm switch off.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"BOXFAILSAFE")),(0,u.kt)("td",null,"The 'FAILSAFE' switch was activated"),(0,u.kt)("td",null,"5"),(0,u.kt)("td",null,"5"),(0,u.kt)("td",null,"5"),(0,u.kt)("td",null,"5"),(0,u.kt)("td",null,"5"),(0,u.kt)("td",null,"5"),(0,u.kt)("td",null,"See ",(0,u.kt)("code",null,"FAILSAFE"))),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"RUNAWAY")),(0,u.kt)("td",null,"Runway Takeoff Prevention has been triggered"),(0,u.kt)("td",null," "),(0,u.kt)("td",null,"6"),(0,u.kt)("td",null,"6"),(0,u.kt)("td",null,"6"),(0,u.kt)("td",null,"6"),(0,u.kt)("td",null,"6"),(0,u.kt)("td",null,"Disarm to clear this condition.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"CRASH")),(0,u.kt)("td",null,"Crash Recovery has been triggered"),(0,u.kt)("td",null," "),(0,u.kt)("td",null," "),(0,u.kt)("td",null," "),(0,u.kt)("td",null," "),(0,u.kt)("td",null,"7"),(0,u.kt)("td",null,"7"),(0,u.kt)("td",null,"Disarm to clear this condition.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"THROTTLE")),(0,u.kt)("td",null,"Throttle channel is too high"),(0,u.kt)("td",null,"6"),(0,u.kt)("td",null,"7"),(0,u.kt)("td",null,"7"),(0,u.kt)("td",null,"7"),(0,u.kt)("td",null,"8"),(0,u.kt)("td",null,"8"),(0,u.kt)("td",null,"Lower throttle below ",(0,u.kt)("code",null,"min_check"),".")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"ANGLE")),(0,u.kt)("td",null,"Craft is not level (enough)"),(0,u.kt)("td",null,"7"),(0,u.kt)("td",null,"8"),(0,u.kt)("td",null,"8"),(0,u.kt)("td",null,"8"),(0,u.kt)("td",null,"9"),(0,u.kt)("td",null,"9"),(0,u.kt)("td",null,"Level craft to within ",(0,u.kt)("code",null,"small_angle")," degrees (default 25).")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"BOOTGRACE")),(0,u.kt)("td",null,"Arming too soon after power on"),(0,u.kt)("td",null,"8"),(0,u.kt)("td",null,"9"),(0,u.kt)("td",null,"9"),(0,u.kt)("td",null,"10"),(0,u.kt)("td",null,"10"),(0,u.kt)("td",null,"10"),(0,u.kt)("td",null,"Wait until ",(0,u.kt)("code",null,"pwr_on_arm_grace")," seconds (default 5) have elapsed.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"NOPREARM")),(0,u.kt)("td",null,"Prearm switch is not activated or prearm has not been toggled after disarm"),(0,u.kt)("td",null,"9"),(0,u.kt)("td",null,"10"),(0,u.kt)("td",null,"10"),(0,u.kt)("td",null,"10"),(0,u.kt)("td",null,"11"),(0,u.kt)("td",null,"11"),(0,u.kt)("td",null,"Toggle the prearm switch.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"LOAD")),(0,u.kt)("td",null,"System load is too high for safe flight"),(0,u.kt)("td",null,"10"),(0,u.kt)("td",null,"11"),(0,u.kt)("td",null,"11"),(0,u.kt)("td",null,"11"),(0,u.kt)("td",null,"12"),(0,u.kt)("td",null,"12"),(0,u.kt)("td",null,"Revisit configuration and disable features.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"CALIB")),(0,u.kt)("td",null,"Sensor calibration is still ongoing"),(0,u.kt)("td",null,"11"),(0,u.kt)("td",null,"12"),(0,u.kt)("td",null,"12"),(0,u.kt)("td",null,"12"),(0,u.kt)("td",null,"13"),(0,u.kt)("td",null,"13"),(0,u.kt)("td",null,"Wait for sensor calibration to complete.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"CLI")),(0,u.kt)("td",null,"CLI is active"),(0,u.kt)("td",null,"12"),(0,u.kt)("td",null,"13"),(0,u.kt)("td",null,"13"),(0,u.kt)("td",null,"13"),(0,u.kt)("td",null,"14"),(0,u.kt)("td",null,"14"),(0,u.kt)("td",null,"Exit the CLI.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"CMS")),(0,u.kt)("td",null,"CMS (config menu) is Active - over OSD or other display"),(0,u.kt)("td",null,"13"),(0,u.kt)("td",null,"14"),(0,u.kt)("td",null,"14"),(0,u.kt)("td",null,"14"),(0,u.kt)("td",null,"15"),(0,u.kt)("td",null,"15"),(0,u.kt)("td",null,"Exit the CMS (or OSD menu).")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"OSD")),(0,u.kt)("td",null,"OSD menu is active"),(0,u.kt)("td",null,"14"),(0,u.kt)("td",null,"15"),(0,u.kt)("td",null,"16"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"Exit OSD menu.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"BST")),(0,u.kt)("td",null,"A Black Sheep Telemetry device (TBS Core Pro for example) disarmed and is preventing arming"),(0,u.kt)("td",null,"15"),(0,u.kt)("td",null,"16"),(0,u.kt)("td",null,"16"),(0,u.kt)("td",null,"15"),(0,u.kt)("td",null,"16"),(0,u.kt)("td",null,"16"),(0,u.kt)("td",null,"Refer to the manual for your hardware.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"MSP")," "),(0,u.kt)("td",null,"MSP connection is active, probably via Betaflight Configurator"),(0,u.kt)("td",null,"16"),(0,u.kt)("td",null,"17"),(0,u.kt)("td",null,"17"),(0,u.kt)("td",null,"16"),(0,u.kt)("td",null,"17"),(0,u.kt)("td",null,"17"),(0,u.kt)("td",null,"Terminate the Betaflight Configurator connection (disconnect).")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"PARALYZE")),(0,u.kt)("td",null,"Paralyze mode has been activated"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"18"),(0,u.kt)("td",null,"17"),(0,u.kt)("td",null,"18"),(0,u.kt)("td",null,"18"),(0,u.kt)("td",null,"Power cycle/reset FC board.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"GPS")),(0,u.kt)("td",null,"GPS rescue mode is configured but required number of satellites has not been fixed"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"19"),(0,u.kt)("td",null,"18"),(0,u.kt)("td",null,"19"),(0,u.kt)("td",null,"19"),(0,u.kt)("td",null,"Wait for GPS fix, enable arming without GPS fix, or disable GPS rescue mode.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"RECOVERY")),(0,u.kt)("td",null,"(wiki incomplete)"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"(wiki incomplete)"),(0,u.kt)("td",null,"(wiki incomplete)"),(0,u.kt)("td",null,"(wiki incomplete)"),(0,u.kt)("td",null,"(wiki incomplete)")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"RESCUE_SW")),(0,u.kt)("td",null,"GPS Rescue switch is in an unsafe position"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"19"),(0,u.kt)("td",null,"20"),(0,u.kt)("td",null,"20"),(0,u.kt)("td",null,"Turn off the GPS Rescue switch to arm.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"RPMFILTER"),(0,u.kt)("sup",null,"(2)")),(0,u.kt)("td",null,"Motor RPM-based filtering is not functioning"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"21"),(0,u.kt)("td",null,"21"),(0,u.kt)("td",null,"21"),(0,u.kt)("td",null,"One or more ESC's are not supplying valid RPM telemetry.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"REBOOT_REQD")),(0,u.kt)("td",null,"Reboot required"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"22"),(0,u.kt)("td",null,"22"),(0,u.kt)("td",null,"Reboot the flight controller for settings changes to take effect.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"DSHOT_BBANG")),(0,u.kt)("td",null,"DSHOT Bitbang is not working"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"23"),(0,u.kt)("td",null,"23"),(0,u.kt)("td",null,"(3)")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"NO_ACC_CAL")),(0,u.kt)("td",null,"Accelerometer calibration required"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"24"),(0,u.kt)("td",null,"Calibrate the accelerometer or disable features that use it")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"MOTOR_PROTO")),(0,u.kt)("td",null,"ESC/Motor Protocol not configured"),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null),(0,u.kt)("td",null,"25"),(0,u.kt)("td",null,"Select the ESC/Motor protocol to use on the Configuration tab.")),(0,u.kt)("tr",null,(0,u.kt)("td",null,(0,u.kt)("code",null,"ARMSWITCH")),(0,u.kt)("td",null,"Arm switch is in an unsafe position"),(0,u.kt)("td",null,"17"),(0,u.kt)("td",null,"18"),(0,u.kt)("td",null,"20"),(0,u.kt)("td",null,"21"),(0,u.kt)("td",null,"24"),(0,u.kt)("td",null,"26"),(0,u.kt)("td",null,"Toggle the arm switch to arm."))),(0,u.kt)("p",null,'(1) This may appear on the Betaflight OSD during flight, take it as a sign that your radio system is either faulty or you are flying at the edge of your range. Treat it the same you would an "RSSI critically low" warning.'),(0,u.kt)("p",null,"(2) RPM-based filtering is enabled but one or more ESC's are not supplying valid DSHOT telemetry. Check that the ESC's are capable of and have the required firmware installed to support bidirectional DSHOT telemetry."),(0,u.kt)("p",null,"(3) Bitbang DSHOT is not working properly and the motors can't be controlled. Likely caused by a timer conflict with other features enabled on the flight controller."))}s.isMDXComponent=!0}}]);